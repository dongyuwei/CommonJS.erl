CommonJS.erl
=====
A CommonJS Packager in Erlang.

# Project Goal: speed, speed, and speed!
1. Bundle Common JS modules concurrently using Erlang processes. It is expected to work like [browserify](https://github.com/substack/node-browserify).
2. Watch and incrementally rebuild Common JS modules concurrently using Erlang processes. It is expected to work like [watchify](https://github.com/substack/watchify).
3. It's expected to be a tiny and simple CommonJS Packager. I do't plan to implement all the features like [browserify](https://github.com/substack/node-browserify).

## Status
1. The core features of Common Js packager/loader was done(It can bundle the `tests/commonjs/entry.js` now). 
2. Watch and rebuild feature was done:
    1. If the changed js's dependencies also changed, process the js and it's dependent modules.
    2. If the dependencies of the changed js are not changed, only update the changed js itself.
3. Still work in progress. 

The project structure was generated by `rebar3 new lib commonjs`


Build
-----

    $ rebar3 compile

API
-----
1. `commonjs:bundle_single_js(Js_entry_file)`
2. `commonjs:bundle_js_in_dir(Input_dir, Watch_mode)`
3. `commonjs:start_server(Assets_dir, Port).`
    1. start dev server: `commonjs:start_server("./tests/commonjs", 8020).`
    2. visit http://127.0.0.1:8020/static/index.html
4. `commonjs:stop_server`

Test in erl shell:
-----
    $ rebar3 shell
    $ os:cmd("rm ./tests/**/*-bundled.js").
    $ r3:do(compile).
    $ commonjs:bundle_js_in_dir("./tests", false).
    $ {ok, Content} = file:read_file("tests/commonjs/entry.js.txt").
    $ Content =:= list_to_binary(os:cmd("node ./tests/commonjs/entry.js-bundled.js")).
